# 可持久化并查集 学习笔记

#### 前置技能

主席树及其常用操作（动态开点，可持久化）、并查集及其常用操作（启发式合并）

> [!caution]
>
> #### 并查集中有几种合并方式：
>
> - 一种是直接暴力连父亲（这显然很劣）
> - 一种是路径压缩的合并（这个在普通并查集中很常用，但是好像无法在可持久化并查集中用，听说是可以构造数据使可持久化并查集的空间爆掉？）
> - 还有一种是按秩（深度或子集大小）合并，也就是可持久化并查集中常用的合并方式！其实也就是一种类似于启发式合并的方式，每一次合并时选择一个小的集合向大的集合合并。这样就可以保证并查集的高度不会增长的太快，保证高度尽量均衡，从而避免退化。

## 步入正题——可持久化并查集

其实我们可以发现看懂了前置技能后，可持久化并查集已经不难实现。

可持久化并查集其实就是指的用可持久化数组维护并查集中的FaFa与按秩合并所需要的depdep

所谓**可持久化并查集**，可以进行的操作就只有几个：

1. 回到历史版本（也就是可持久化）
2. 合并两个集合
3. 查询节点所在集合的祖先
4. 判断是否在同一个集合中（也就是并查集）

对于1操作，我们可以很轻松的利用可持久化数组（或主席树）实现。

对于2操作，其实也就是在前置技能中所说的按秩合并

对于3&4操作，也就是在可持久化数组中查询

