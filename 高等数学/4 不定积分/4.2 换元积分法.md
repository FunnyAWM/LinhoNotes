# 4.2 换元积分法

## 第一类换元积分法

### 引入

考虑这个不定积分：

$$
\int\cos(e^x)\cdot e^x{\rm d}x
$$

如果眼力比较好，可以看出 $[\sin(e^x)]'=\cos(e^x)e^x$。但如果函数的形式更加复杂，就比较难看出来了。

这里我们考虑 $e^x{\rm d}x$，根据一元函数微分的定义：

$$
{\rm d}f(x)={{\rm d}f(x)\over{\rm d}x}{\rm d}x=f'(x){\rm d}x
$$

因此

$$
e^x{\rm d}x={{\rm d}e^x\over{\rm d}x}{\rm d}x={\rm d}e^x
$$

所以这样处理后，原来的式子变成

$$
\int\cos(e^x)\textcolor{red}{e^x{\rm d}x}=\int\cos(e^x)\textcolor{red}{{\rm d}e^x}
$$

把微分符号 ${\rm d}$ 后面的内容看成整体，也就是把 $e^x$ 看做积分变量：

$$
\int\cos(\textcolor{red}{e^x}){\rm d}\textcolor{red}{e^x}
$$

不妨设 $u=e^x$，就有

$$
\int\cos(\textcolor{red}{u}){\rm d}\textcolor{red}{u}=\sin\textcolor{red}u+C
$$

也就是说

$$
\int\cos(e^x)e^x{\rm d}x
=\int\cos(\textcolor{red}{e^x}){\rm d}\textcolor{red}{e^x}
=\sin\textcolor{red}{e^x}+C
$$

### 定义

设 $\int f(u){\rm d}u=F(u)+C$ 且 $u=\varphi(x)$ 可导，则由复合函数微分法和不定积分定义，有

$$
\begin{gathered}
\int f\big[\varphi(x)\big]\varphi'(x){\rm d}x=\int f\big[\varphi(x)\big]{\rm d}\varphi(x) \\
=\int f(u){\rm d}u=F(u)+C=f\big[\varphi(x)\big]+C
\end{gathered}
$$

这件事的本质是复合函数求导的逆运算。

这里的关键就是把 $\varphi'(x){\rm d}x$ 变成 ${\rm d}\varphi(x)$，也就是求 $\varphi'(x)$ 的原函数。这个步骤通常叫**凑微分**。

> [!note]
>
> 更精准地说，不定积分不是求导的逆运算，而是**微分的逆运算**。
>
> 例如，
>
> $$
> \int 2x{\rm d}x
> $$
>
> 这里 $2x{\rm d}x$ 是一个整体，是一个微分。我们在这个整体上施加一个积分算符 $\int$，找哪个函数的**微分**等于 $2x{\rm d}x$。
>
> 所以积分和微分才是真正的一对。
>
> 所以有
>
> $$
> \int F(x){\rm d}x=\int{\rm d}F(x)=F(x)+C
> $$
>
> 这里的积分符号 $\int$ 和 微分符号 ${\rm d}$ 就有了一种「抵消感」。

### 常用凑微分方法

$$
\def\dx{\,{\rm d}x}
\def\d{\,{\rm d}}
\begin{align}
&\int f(ax+b)\textcolor{red}\dx
 =\textcolor{red}{\frac1a}\int f(ax+b)\textcolor{red}{\d(ax+b)}\quad\small{(a\ne 0)} \\
&\int f(\sin x)\textcolor{red}{\cos x\dx}=\int f(\sin x)\textcolor{red}{\d\sin x} \\
&\int f(\ln x)\textcolor{red}{\frac1x\dx}=\int f(\ln x)\textcolor{red}{\d\ln x}\\
&\int f(\sqrt x)\textcolor{red}{\frac\dx{\sqrt x}}=\textcolor{red}2\int f(\sqrt x)\textcolor{red}{\d\sqrt x} \\
&\int f(\arctan x)\textcolor{red}{{\rm d}x\over1+x^2}=\int f(\arctan x)\textcolor{red}{\d\arctan x}
\end{align}
$$

---

**例 1**

$$
\begin{align}
\int \cos(2x+3){\rm d}x&=\frac12\int\cos(2x+3){\rm d}(2x+3)\\
&=\frac12\sin(2x+3)+C
\end{align}
$$

---

**例 2**

$$
\begin{align}
\int{\ln^2x\over x}{\rm d}x&=\int\ln^2x\cdot\frac1x{\rm d}x\\
&=\int \ln^2x\,{\rm d}\ln x \\
&=\frac13\ln^3x+C
\end{align}
$$

---

**例 3** 推导 $\tan x$ 的不定积分公式。

$$
\def\d{{\rm d}}
\begin{align}
&\hspace{24mu}\int\tan x\,\d x \\
&=\int{\textcolor{red}{\sin x}\over\cos x}\textcolor{red}{\d x} \\
&=-\int{1\over\cos x}\d\cos x \\
&=-\ln\left|\cos x\right|+C
\end{align}
$$

---

**例 4** 推导不定积分公式：

$$
\int\frac1{\sqrt{a^2-x^2}}{\rm d}x\quad(a>0)
$$

> [!tip]
>
> 目标：化为公式
>
> $$
> \int\frac1{\sqrt{1-x^2}}{\rm d}x=\arcsin x+C
> $$

$$
\def\d{{\rm d}}
\begin{align}
原式&=\int\frac1{\sqrt{a^2\left[1-(\frac xa)^2\right]}}\,\d x \\
&=\frac1a\int\frac1{\sqrt{1-(\frac xa)^2}}\,\d x \\
&=\int\frac1{\sqrt{1-(\frac xa)^2}}\,\d\left(\frac xa\right) \\
&=\arcsin\frac xa+C
\end{align}
$$

> [!tip]
>
> 以后这个公式就可以直接用了。例如：
>
> $$
> \begin{align}
> \int\frac1{\sqrt{3-x^2}}{\rm d}x
> &=\int\frac1{\sqrt{(\sqrt3)^2-x^2}}{\rm d}x \\
> &=\arcsin\frac x{\sqrt3}+C
> \end{align}
> $$

---

**例 5**

$$
\begin{align}
\int \frac{\textcolor{red}{{\rm d}x}}{\textcolor{red}{\sqrt x}(1+x)}
&=\textcolor{red}2\int\frac1{1+(\sqrt x)^2}\textcolor{red}{{\rm d}\sqrt x} \\
&=2\arctan \sqrt x +C
\end{align}
$$
