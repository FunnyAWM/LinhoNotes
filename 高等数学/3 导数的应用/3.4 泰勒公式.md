# 3.4 泰勒公式

## 引入

目标：找到一个高精确度的表达式来近似表达一个函数，使得其与原函数之差比某个给定的无穷小更高阶。

设 $f(x)$ 在 $x_0$ 处具有 $n$ 阶导数，试找出一个关于 $x-x_0$ 的 $n$ 次多项式

$$
p_n(x)=a_0+a_1(x-x_0)+a_2(x-x_0)^2+\cdots+a_n(x-x_0)^n
$$

来近似表达 $f(x)$，要求使得 $p_n(x)$ 与 $f(x)$ 之差是当 $x\to x_0$ 时比 $(x-x_0)^n$ 高阶的无穷小。

假设 $p_n(x)$ 在 $x_0$ 处的函数值及它的直到 $n$ 阶导数在 $x_0$ 处的值依次与 $f(x_0),f'(x_0),\cdots,f^{(n)}(x_0)$ 相等，即满足：

$$
\begin{align}
p_n(x_0)=f(x_0) &\Rightarrow a_0=f(x_0) \\
p_n'(x_0)=f'(x_0) &\Rightarrow a_1={f'(x_0)\over1} \\
p_n''(x_0)=f''(x_0) &\Rightarrow a_2={f''(x_0)\over2!} \\
p_n'''(x_0)=f'''(x_0) &\Rightarrow a_3={f'''(x_0)\over3!} \\
&\cdots \\
p_n^{(n)}(x_0)=f^{(n)}(x_0) &\Rightarrow a_n={f^{(n)}(x_0)\over n!}
\end{align}
$$

于是我们有了泰勒定理。

## 泰勒中值定理

### 泰勒中值定理 1

**如果函数 $f(x)$ 在 $x_0$ 处具有 $n$ 阶导数，那么存在 $x_0$ 的一个邻域，对于该邻域内的任一 $x$，有**

$$
\begin{align}
f(x)=f(x_0)+f'(x_0)(x-x_0)+{f''(x_0)\over2!}(x-x_0)^2+\cdots+{f^{(n)}(x_0)\over n!}(x-x_0)^n\\+R_n(x)
\end{align}
$$

其中 $R_n(x)=o((x-x_0)^n)$，称为**佩亚诺余项**。

上面的公式称为**带有佩亚诺余项的 $n$ 阶泰勒公式**，该多项式的前 $n-1$ 项（即不含 $R_n(x)$）称为**函数 $f(x)$ 在 $x_0$ 处（或按 $x-x_0$ 的幂展开）的 $n$ 次泰勒多项式**。

但是由 $R_n(x)$ 的形式无法估算误差的大小，所以有了另一种形式。

### 泰勒中值定理 2

**如果函数如果函数 $f(x)$ 在 $x_0$ 的某个邻域 $U(x_0)$ 内具有 $n+1$ 阶导数，那么 $\forall x\in U(x_0)$，有**

$$
\begin{align}
f(x)=f(x_0)+f'(x_0)(x-x_0)+{f''(x_0)\over2!}(x-x_0)^2+\cdots+{f^{(n)}(x_0)\over n!}(x-x_0)^n\\+R_n(x)
\end{align}
$$

其中

$$
R_n(x)={f^{(n+1)}(\xi)\over(n+1)!}(x-x_0)^{n+1}
$$

这里 $\xi$ 是 $x_0$ 与 $x$ 之间的某个值。$R_n$ 称为**拉格朗日余项**。

上面的公式称为**带有拉格朗日余项的 $n$ 阶泰勒公式**。

该定理的证明，实质上就是 [3.1 中的最后一道例题](./3.1%20微分中值定理#通往泰勒的一道例题)。

> [!tip]
>
> 一般地，求极限时多用佩亚诺余项，证明时常用拉格朗日余项。

### 麦克劳林公式

取 $x_0=0$，我们可以得到：

$$
f(x)=f(0)+f'(0)+\cdots+{f^{(n)}(0)\over n!}+R_n(x)
$$

该公式称为麦克劳林公式。

误差估计式相应地变为

$$
|R_n|\le{M\over(n+1)!}|x|^{n+1}
$$

## 常用展开式

> [!warning]
>
> 下面五个公式要求牢记。

$$
\begin{align}
e^x&=1+x+{x^2\over2!}+{x^3\over3!}+\cdots+{x^n\over n!}+R_n(n) \\
\ln x&=x-{x^2\over2}+{x^3\over3}-{x^4\over 4}+\cdots+{(-1)^{n-1}x^n\over n}+R_n(x) \\
\sin x&=x-{x^3\over3!}+{x^5\over5!}-{x^7\over7!}+\cdots+{(-1)^nx^{2n+1}\over(2n+1)!}+R_{2n+2}(x) \\
\cos x&=1-{x^2\over2!}+{x^4\over4!}-{x^6\over6!}+\cdots+{(-1)^nx^{2n}\over(2n)!}+R_{2n+1}(x) \\
(1+x)^\alpha&=1+\alpha x+{\alpha(\alpha-1)\over2!}x^2+\cdots{\alpha(\alpha-1)\cdots(\alpha-n+1)\over n!}+R_n(x)
\end{align}
$$

> [!note]
>
> 下面三个公式了解即可。

$$
\begin{align}
\arcsin x&=x+{1\over6}x^3+{3\over40}x^5+{5\over112}x^7+\cdots \\
\tan x&=x+{1\over3}x^3+{2\over15}x^5+{17\over315}x^7+\cdots \\
\sec x&=1+{1\over2}x^2+{5\over24}x^4+{61\over720}x^6+\cdots \\
\end{align}
$$

实际上，这三个拓展公式已经在常见等价无穷小处得到体现。直到阶数分布即可，前面的常数推导这里不展开。
